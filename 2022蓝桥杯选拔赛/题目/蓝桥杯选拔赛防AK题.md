# 蓝桥杯选拔赛防 AK 题

## 抢红包

gzp 最近由于找工作刷 leetcode 加入了一个“残酷刷题群”，[群规](https://board.cruelcoding.com/rules.html)真的非常残酷，14 条群规有 9 条都需要发红包，严格执行的群规导致新人的高淘汰率，高淘汰率同时决定群内留下的都是高质量“刷题家”，其中不乏三四名 leetcode rating 全国排名前 10 或者 cf 红名大神。

每次周赛结束后就是群里的红包高峰期，现假设一个拼手气红包内总共有 $m$ 分（红包金额的最小单位：分），群里有 $n$ 人抢红包，第 $i~(i\neq n)$ 个人打开红包时，若此时红包还剩下 $x$ 分，他可以等概率地抢到在 $[1,x-(n-i)]$ 区间内的红包金额，即最少 $1$ 分红包，最多也要给还没抢到红包的 $n-i$ 人每人留 $1$ 分，第 $n$ 个人将得到剩下所有红包，问最后一个人抢到红包的期望值。

注：

- 请忽略实际拼手气红包的分配规则，以题面描述规则计算期望；
- 期望的计算规则：设第 $n$ 个人有 $p_1$ 的概率得到 $x_1$ 分，有 $p_2$ 的概率得到 $x_2$ 分……有 $p_k$ 的概率得到 $x_k$ 分，则他获得红包的期望值为：$\sum_{i=1}^kp_ix_i$。

### 输入

输入包含两个整数 $n,m$，分别表示抢红包的人数与红包金额（单位：分）。

对于 $5\%$ 的数据，$1\leq n\leq2,~2\leq m\leq100$；

对于 $20\%$ 的数据，$1\leq n\leq m\leq100$；

对于 $100\%$ 的数据，$1\leq n\leq m\leq5000$。

### 输出

若最后一个人抢到红包的期望值用分数表示为 $E=\frac{p}{q}$，则输出一个整数 $E'$ 满足 $E'\times q\equiv p\mod10^9+7$（或者说 $E'\times q~\%~(10^9+7)=p~\%~(10^9+7)$）。

### 样例输入

```
2 6
```

### 样例输出

```
3
```

### 样例解释

第二个人得到红包的金额概率分布为：

| 金额（单位：分） | 1             | 2             | 3             | 4             | 5             |
| :--------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| 概率             | $\frac{1}{5}$ | $\frac{1}{5}$ | $\frac{1}{5}$ | $\frac{1}{5}$ | $\frac{1}{5}$ |

因此获得的红包金额期望为：

$$E=1\times\frac{1}{5}+2\times\frac{1}{5}+3\times\frac{1}{5}+4\times\frac{1}{5}+5\times\frac{1}{5}=3$$

## 移花接木

《小鱼儿与花无缺》中嫁衣神功最高一重“移花接木”被存于六壬神骰之中，相传只有聪明绝顶的人才能解开它。江玉燕根据制作六壬神骰的工匠是胡人，猜测曾经听到过胡曲的音律就是开启六壬神骰的顺序，顺利学得绝世神功，走上了一条不择手段的的道路。

时间轴推到大结局，小鱼儿已经服下赌王圣水，去找江玉燕同归于尽——终于解除麻痹的花无缺一怒之下把六壬神骰扔向墙角，神骰显示出一段文字，只要花无缺能用移花接木的方法 $1s$ 内解开文字中的问题，他就能用 $1s$ 学会移花接木的克星“空木葬花”，前去拯救小鱼儿！

展示在花无缺面前的文字是这样的：

在一个 $n\times m$ 的矩阵里有任意自然数，用 $a_{ij}$ 表示第 $i$ 行第 $j$ 列的数字，除 $0$ 以外保证每个数字都只出现一次，你可以使用移花接木对任意两行或者两列进行交换，虽然你内力深厚，但也请在 $1s$ 内尽量少用移花接木，让矩阵内数字分布满足如下规则：

对于任意非零正整数：

1. 对于任意一行 $r$，若数字 $a_{ri}$ 是 $a_{rj}$ 的约数，则 $a_{ri}$ 必须放在 $a_{rj}$ 的左边（即 $i<j$）；
2. 对于任意一列 $c$，若 $a_{ic}<a_{jc}$，则 $a_{ic}$ 必须放在 $a_{jc}$ 之上（即 $i<j$）。

时间紧迫，小花能否留下足够的内力，及时赶到救回小鱼儿，就靠你了！

### 输入

第一行一个整数 $T$，表示有 $T$ 组数据；第二行两个整数 $n,m$，分别表示矩阵的行数与列数；后面 $n$ 行每行 $m$ 个自然数 $a_{ij}$ ，即矩阵中第 $i$ 行第 $j$ 列的数字。

对于 $10\%$ 的数据，$1\leq n,m\leq10$；

对于 $20\%$ 的数据，$1\leq n,m\leq1000$；

对于 $100\%$ 的数据，$1\leq T\leq 10,1\leq n\times m\leq 10^5,0\leq a_{ij}\leq10^6$，数据保证矩阵大小总和不超过 $10^6$。

### 输出

若可以在有限次内解出六壬神骰的规则，输出需要使用移花接木的最少次数，若不可以，输出 $-1$。

### 样例输入

```
2
2 3
2 8 4
9 3 27
2 3
3 18 60
2 8 4
```

### 样例输出

```
-1
2
```

### 样例解释

第二组数据可以将矩阵变化为

```
2 4 8
3 60 18
```

由于 $60$ 不是 $18$ 的倍数，所以不需要放在 $18$ 后面，而 $60$ 与 $18$ 必须放在 $3$ 的后面，最少需要 $2$ 次交换。

## 大禹治水

时间限制：$2s$

上古时期洪水肆虐，大禹接受帝舜的任命前去治水。由于灾情紧急，所以大禹每天夜以继日地工作。期间他多次路过自己的家门口，却没有进去探望家人。最终，大禹花费十三年时间，耗尽心力，终于完成了治水大业。大禹也因此声名鹊起，得到了天下人的拥护和爱戴。

大禹在治水过程中经过 $n$ 个地点，从 $1$ 到 $n$ 对其进行编号，总共有 $m$ 条道路连接这些地方，大禹的家被编号为 $1$，与大禹的家仅相隔一条道路的地点都称为“家门口”，禹已经过这些地点无数次，他想知道，从家里出发，经过 $1$ 条道路、$2$ 条道路……$k$ 条道路之后，总共有多少种走法在不入家门的情况下能恰好到达家门口？由于走法可能非常多，需要将最终的走法对 $p$ 取余后输出。

>  “禹伤先人父鲧功之不成受诛，乃劳身焦思，居外十三年，过家门**不敢入**。”
>
> <p align="right">——《史记 · 夏本纪》</p>

###  输入

本题有多个测试点，每个测试点数据范围不同。

第一行为一个整数 $Case$，表示测试点编号。第二行四个整数 $n,m,k,p$，分别表示地点数、道路数、最多可以经过的道路数与需要取余的模数，接下去 $m$ 行，每行两个整数 $u,v$，表示在地点 $u$ 与 $v$ 之间有一条道路连接。

当 $Case\in[1,10]$ 时，$2\leq n,m,k\leq7,~p=10^9+7$；

当 $Case\in[11,30]$ 时，$2\leq n\leq50,~1\leq m\leq10^6,~1\leq k\leq10^6,~10^7\leq p\leq10^9$；

当 $Case\in[31,50]$ 时，$2\leq n\leq4,~1\leq m\leq10^6,~1\leq k\leq10^{100000},~1\leq p\leq4$；

对于所有 $Case$，$1\leq u,v\leq n$。

### 输出

对于每个测试点，输出方案数对 $p$ 取余后的结果。

### 样例输入

```
1
3 3 3 1000000007
1 2
2 3
3 1
```

### 样例输出

```
6
```

### 样例解释

大禹从家里 $1$ 出发，在 $3$ 条道路内行走而不入家门的所有走法有：

经过一条道路：

- 1 → 2
- 1 → 3

经过两条道路：

- 1 → 2 → 3
- 1 → 3 → 2

经过三条道路：

- 1 → 2 → 3 → 2
- 1 → 3 → 2 → 3

正好到达 $2$ 的有 $3$ 次，正好到达 $3$ 的也有 $3$ 次，而 $2$ 与 $3$ 都是“家门口”，因此在三条道路内恰好到达“家门口”的总走法有 $6$ 种。